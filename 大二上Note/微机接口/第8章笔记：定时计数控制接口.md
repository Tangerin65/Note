[[Chapter8.pdf#page=13&selection=55,0,98,5|Chapter8, p.13]]## 0. 目录：8253芯片
 - 引脚
 - 6种工作方式
 - 编程
 - 在IBM PC机上的应用

## 1.定时功能实现方法 
[[Chapter8.pdf#page=1&selection=17,0,17,20&color=yellow|Chapter8, p.1]]
三种方法：
 - 软件延时
 - 不可编程的硬件延时
 - 可编程的硬件延时:8253/8254

---
## 2.8253/8254相关
#### 1.intro
[[Chapter8.pdf#page=1&selection=107,0,114,4&color=yellow|Chapter8, p.1]]
8254 = 8253Evo
#### 2.内部结构
[[Chapter8.pdf#page=2&selection=75,0,79,6&color=yellow|Chapter8, p.2]]

#### 3.引脚
1. 与外界接口：[[Chapter8.pdf#page=2&selection=83,0,84,8&color=yellow|Chapter8, p.2]]
 - CLK：下降沿触发
 - GATE：注意GATE信号是外部输入信号
 - OUT：once计数过程结束产生信号
1. 与处理器接口：![[Chapter8.pdf#page=2&rect=30,40,563,189|Chapter8, p.2]]

#### 4.工作方式
共6种，由方式控制字决定，工作方式过程大致相似：[[Chapter8.pdf#page=3&selection=11,16,11,31&color=yellow|Chapter8, p.3]]
![[Chapter8.pdf#page=3&rect=38,485,570,685&color=yellow|Chapter8, p.3]]
**方式0：计数结束中断**：[[Chapter8.pdf#page=3&selection=123,0,125,6&color=yellow|Chapter8, p.3]]	
老式闹钟：设定时间 $N$，计时期间 $LOW$，时间一到响起（$HIGH$）并停止，这个信号可用作中断请求信号。GATE低时闹钟计时暂停。
**方式1：可编程单稳脉冲**：[[Chapter8.pdf#page=4&selection=7,0,12,7&color=yellow|Chapter8, p.4]]
可再触发的弹球游戏机：$GATE$ 信号的上升沿是投入硬币（触发），一旦触发，输出就会产生一个低电平脉冲（游戏时间 $N$）。如果在游戏结束前再次投入硬币（再次触发），游戏时间会重新开始计时，这体现了它的可再触发特性。注意它和方式5一样都是硬件触发
**方式2：频率发生器/分频器**：[[Chapter8.pdf#page=4&selection=174,1,176,1|Chapter8, p.4]]
电子节拍器：你设定好 $N$ 间隔后，它每 $N$ 个时钟周期就会自动打一次响指（输出一个窄脉冲），然后立即自动重置，等待下一个周期。这种方式主要用于需要精确分频和周期性窄脉冲信号的场合。
**方式3：方波发生器**：[[Chapter8.pdf#page=4&annotation=225R|Chapter8, p.4]]
平衡的摇摆木马：设定周期 $N$ 后，它会在高电平状态下摇摆 $N/2$ 时间，然后在低电平状态下摇摆 $N/2$ 时间，自动循环，产生均匀的脉冲信号。
**方式4：软件触发选通信号**：[[Chapter8.pdf#page=5&annotation=228R|Chapter8, p.5]]
即时倒计时闹钟：你通过程序设定时间 $N$ 后，闹钟会立即开始倒计时。时间一到，它只会“叮”地响一声（一个极窄的脉冲）然后停止，不需要外部按钮启动。
**方式5：硬件触发选通信号**：[[Chapter8.pdf#page=5&annotation=231R|Chapter8, p.5]]
触控式倒计时闹钟：设定时间 N 后它会保持待命，只有当你按下 GATE 按钮（接收到上升沿）后，它才开始倒计时。如果在倒计时过程中再次按下按钮，计时会重新开始，这使它成为可再触发的外部事件延时控制器。

**SUM:GATE信号的作用**：
![[Chapter8.pdf#page=6&rect=34,341,546,493|Chapter8, p.6]]

---
## 3.8253/54编程
#### 1.写入方式控制字
![[Chapter8.pdf#page=6&rect=282,46,562,215|Chapter8, p.6]]
代码示例见[[Chapter8.pdf#page=7&annotation=240R|Chapter8, p.7]]

#### 2.读写计数值
[[Chapter8.pdf#page=7&annotation=248R|Chapter8, p.7]]
P.S. 8253只有8位数据线，16位计数值传输要分两次：[[Chapter8.pdf#page=7&annotation=245R|Chapter8, p.7]]

#### 3.8254读回命令
[[Chapter8.pdf#page=7&annotation=263R|Chapter8, p.7]]
它允许程序在一个命令中同时冻结（锁存）指定计数器当前的 16 位计数值和/或它的工作状态字。确保在分两次读取 16 位计数值时，高位和低位是在同一时刻被捕获的，解决了传统 8253 芯片在读取过程中可能出现的数据不一致问题。即**在不干扰高速运转的计数器的情况下，安全地抓取一个精确瞬间的完整数据。**

---
## 4.8253×IBM PC
1. 计数器0：定时中断[[Chapter8.pdf#page=8&annotation=251R|Chapter8, p.8]]
2. 计数器1：定时刷新[[Chapter8.pdf#page=9&annotation=254R|Chapter8, p.9]]
3. 计数器2：扬声器发声音调控制[[Chapter8.pdf#page=9&annotation=257R|Chapter8, p.9]]

---
## 5.可编程硬件延时：日时钟
[[Chapter8.pdf#page=10&annotation=260R|Chapter8, p.10]]
